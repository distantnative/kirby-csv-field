(function(){"use strict";function c(e,t,n,a,r,l,u,b){var i=typeof e=="function"?e.options:e;t&&(i.render=t,i.staticRenderFns=n,i._compiled=!0),a&&(i.functional=!0),l&&(i._scopeId="data-v-"+l);var o;if(u?(o=function(s){s=s||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!s&&typeof __VUE_SSR_CONTEXT__<"u"&&(s=__VUE_SSR_CONTEXT__),r&&r.call(this,s),s&&s._registeredComponents&&s._registeredComponents.add(u)},i._ssrRegister=o):r&&(o=b?function(){r.call(this,(i.functional?this.parent:this).$root.$options.shadowRoot)}:r),o)if(i.functional){i._injectStyles=o;var g=i.render;i.render=function(k,d){return o.call(d),g(k,d)}}else{var f=i.beforeCreate;i.beforeCreate=f?[].concat(f,o):[o]}return{exports:e,options:i}}const p={extends:"k-files-field",props:{columns:Object,limit:Number},data(){return{rows:null,page:1}},computed:{cols(){return this.columns?Object.fromEntries(Object.keys(this.columns).map(e=>[this.columns[e].key??e,this.columns[e]])):this.rows?Object.fromEntries(Object.keys(this.rows[0]).map(e=>[e,{label:e}])):[]},file(){return this.value[0]},pagination(){return{details:!0,limit:this.limit,page:this.page,total:this.rows.length}},rowsPaginated(){return this.limit?this.rows.slice((this.page-1)*this.limit,this.page*this.limit):this.rows}},watch:{file:{async handler(e){this.rows=null,e&&(this.rows=await this.$api.get(this.endpoints.field+"/preview",{file:e.id}))},immediate:!0}}};var h=function(){var t=this,n=t._self._c;return n("k-field",t._b({staticClass:"k-models-field k-csv-field",scopedSlots:t._u([t.disabled?null:{key:"options",fn:function(){return[t.file?n("k-button",{attrs:{responsive:!0,text:t.$t("remove"),icon:"remove",size:"xs",variant:"filled"},on:{click:function(a){return t.remove(0)}}}):n("k-button-group",{ref:"buttons",staticClass:"k-field-options",attrs:{buttons:t.buttons,layout:"collapsed",size:"xs",variant:"filled"}})]},proxy:!0}],null,!0)},"k-field",t.$props,!1),[n("k-dropzone",{attrs:{disabled:!t.hasDropzone},on:{drop:t.drop}},[t.rows?n("k-table",{attrs:{columns:t.cols,rows:t.rowsPaginated,pagination:t.pagination},on:{paginate:function(a){t.page=a.page}}}):t.file?n("k-empty",{attrs:{text:"Loading tableâ€¦",icon:"loader",layout:"table"}}):n("k-empty",{attrs:{icon:"table",layout:"table",text:"Select or upload CSV file"},on:{click:t.open}})],1)],1)},_=[],m=c(p,h,_,!1,null,null,null,null);const v=m.exports;panel.plugin("distantnative/kirby-csv-field",{fields:{csv:v}})})();
