(function(){"use strict";function p(e,t,n,l,a,r,u,b){var i=typeof e=="function"?e.options:e;t&&(i.render=t,i.staticRenderFns=n,i._compiled=!0),l&&(i.functional=!0),r&&(i._scopeId="data-v-"+r);var o;if(u?(o=function(s){s=s||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!s&&typeof __VUE_SSR_CONTEXT__<"u"&&(s=__VUE_SSR_CONTEXT__),a&&a.call(this,s),s&&s._registeredComponents&&s._registeredComponents.add(u)},i._ssrRegister=o):a&&(o=b?function(){a.call(this,(i.functional?this.parent:this).$root.$options.shadowRoot)}:a),o)if(i.functional){i._injectStyles=o;var g=i.render;i.render=function(k,d){return o.call(d),g(k,d)}}else{var f=i.beforeCreate;i.beforeCreate=f?[].concat(f,o):[o]}return{exports:e,options:i}}const c={extends:"k-files-field",props:{columns:Object},data(){return{rows:null,pagination:null}},computed:{button(){return[{icon:"remove",responsive:!0,size:"xs",text:this.$t("remove"),variant:"filled",click:()=>this.clear()}]},file(){var e;return(e=this.selected[0])==null?void 0:e.id},table(){return{columns:Object.fromEntries(Object.keys(this.columns??this.rows[0]??[]).map(e=>{var t,n;return[((t=this.columns)==null?void 0:t[e].key)??e,((n=this.columns)==null?void 0:n[e])??{label:e}]})),index:this.pagination?(this.pagination.page-1)*this.pagination.limit+1:null,rows:this.rows,pagination:this.pagination?{...this.pagination,details:!0}:!1}}},mounted(){this.preview()},methods:{clear(){this.selected=[],this.rows=null,this.onInput()},onInput(){this.$emit("input",this.selected),this.preview()},async preview(e=1){if(this.file){const{rows:t,pagination:n}=await this.$api.get(this.endpoints.field+"/preview",{file:this.file,page:e});this.rows=t,this.pagination=n}}}};var h=function(){var t=this,n=t._self._c;return n("k-field",t._b({staticClass:"k-models-field k-csv-field",scopedSlots:t._u([t.disabled?null:{key:"options",fn:function(){return[n("k-button-group",{ref:"buttons",staticClass:"k-field-options",attrs:{buttons:t.file?t.button:t.buttons,layout:"collapsed",size:"xs",variant:"filled"}})]},proxy:!0}],null,!0)},"k-field",t.$props,!1),[n("k-dropzone",{attrs:{disabled:!t.hasDropzone},on:{drop:t.drop}},[t.rows?n("k-table",t._b({on:{paginate:function(l){return t.preview(l.page)}}},"k-table",t.table,!1)):t.file?n("k-empty",{attrs:{text:t.$t("field.csv.loading"),icon:"loader",layout:"table"}}):n("k-empty",{attrs:{text:t.$t("field.csv.empty"),icon:"table",layout:"table"},on:{click:t.open}})],1)],1)},_=[],v=p(c,h,_,!1,null,null,null,null);const m=v.exports;panel.plugin("distantnative/kirby-csv-field",{fields:{csv:m}})})();
